---
title: "Dissertation Primary Analysis"
author: "Steven T. Tseng"
date: '`r paste("First created on Dec 24, 2019. Updated on", Sys.Date())`'
output:
  html_notebook:
    theme: cerulean
    highlight: tango
    number_sections: yes
    toc: yes
---

```{r, message = FALSE}
library(dplyr)
library(readxl)
library(psych)
library(effects)
library(ggplot2)
library(Hmisc)
library(xtable)
library(lavaan)
library(magrittr)

options(digits = 4)

theme_set(theme_classic())

dat <- read_xlsx("./Dissertation Data/dissertationdataCOMPLETE.xlsx")
```

# Correlation Matrix (Full)
```{r}
source("corstars.R")

dat %>%
  select(exploitatt:cwb, orgtype:orgcent, status, orgtenure:gender, age, english, edu, racenum, racewb, hrpractices) %>%
  as.matrix(.) %>%
  corstars(., method = "pearson")
```

Note: The following variables are measured on an ordinal scale:

* Org size

* Org levels

* Org centrality

* Salary

* Age

* Education

Use Spearman's rho for these variables.

****

# Spearman Correlations for Some Demographic Variables (Ordinal)
```{r}
source("corstars.R")

dat %>%
  select(orgsize:orgcent, salary, age, edu, orgtype, status, orgtenure:weekhours, gender, english, racenum, racewb, hrpractices, exploitatt:cwb) %>%
  as.matrix(.) %>%
  corstars(., method = "spearman")
```

****
# Means and Standard Deviations
```{r}
dat %>%
  select(orgdehum, exploitatt, wbatt, sblm, soe, jobsat, acommit, burnout, tointent, perf, ocb, cwb, selection, training, appraisal, compensation, hrpractices, orgtype, orgsize, orglevels, orgcent, gender, age, racenum, english, edu, status, orgtenure, postenure, suptenure, dirreport, weekhours, salary) %>%
  psych::describe(.)
```

****

# Correlation Matrix (Partial)
```{r}
# library(htmlTable)

source("corstars.R")

dat %>%
  select(orgdehum, exploitatt, wbatt, sblm, soe, jobsat, acommit, burnout, tointent, perf, ocb, cwb, selection, training, appraisal, compensation, hrpractices, orgtype, orgsize, orglevels, orgcent, gender, age, racenum, english, edu, status, orgtenure, postenure, suptenure, dirreport, weekhours, salary) %>%
  as.matrix(.) %>%
  corstars(., method = "pearson")
  # htmlTable
```

****

# Spearman Correlation Matrix (Partial)
```{r}
source("corstars.R")

dat %>%
  select(orgdehum, exploitatt, wbatt, sblm, soe, jobsat, acommit, burnout, tointent, perf, ocb, cwb, selection, training, appraisal, compensation, hrpractices, orgtype, orgsize, orglevels, orgcent, gender, age, racenum, english, edu, status, orgtenure, postenure, suptenure, dirreport, weekhours, salary) %>%
  as.matrix(.) %>%
  corstars(., method = "spearman")
  # htmlTable
```

****

Several interesting observations:

* For-profit organizations significantly related to higher exploitation HR attributions, BLM, and org dehumanization.

* Org size positively related to performance HR attributions & OCB and negatively related to BLM.

* Org levels positivley related to exploitation & cost HR attributions and negatively related to SOE & POS. Also positively related to both OCBs and CWBs.

* Salary negatively related to exploitation & cost HR attributions, BLM , & org dehumanization and positivley related to well-being attributions and POS.

* Being responsible for direct reports positively related to well-being HR attributions and negatively related to org dehumanization.

* Tenure variables and weekly hours not related to variables of interest.

* Status, gender, and age not related to variables of interest.

****

# Hypothesis Tests

****

## Hypothesis 1

> Employee HR attributions are related to employee perceptions of organizational dehumanization. Specifically, (a) employees who tend to make employee-centric attributions perceive low levels of dehumanization whereas (b) employees who tend to make organizationcentric attributions perceive high levels of dehumanization.

```{r}
cor.test(dat$wbatt, dat$orgdehum, method = "pearson")
```

```{r}
cor.test(dat$exploitatt, dat$orgdehum, method = "pearson")
```

Hypothesis 1 is supported.

```{r}
dat %>%
  ggplot(aes(x = wbatt, y = orgdehum)) + geom_point() + geom_smooth(method = "lm") +
  scale_x_continuous("Employee-centric HR Attributions", breaks = c(1:7)) +
  scale_y_continuous("Organizaitonal Dehumanization", breaks = c(1:7))
```

```{r}
dat %>%
  ggplot(aes(x = exploitatt, y = orgdehum)) + geom_point() + geom_smooth(method = "lm") +
  scale_x_continuous("Organization-centric HR Attributions", breaks = c(1:7)) +
  scale_y_continuous("Organizaitonal Dehumanization", breaks = c(1:7))
```

Since previous data exploration revealed that variables of interest are non-normally distributed, conduct two additional tests to affirm results:

* Kendall's tau-b

* Visual inspection of regression diagnostic plots

```{r}
cor.test(dat$wbatt, dat$orgdehum, method = "kendall")
cor.test(dat$exploitatt, dat$orgdehum, method = "kendall")
```

```{r}
plot(lm(orgdehum ~ exploitatt, data = dat))
```

```{r}
plot(lm(orgdehum ~ wbatt, data = dat))
```

Kendall's tau aligns with Pearson's r and no significant abnormalities spotted in the diagnostic plots.

Plot 1 (Residausl vs Fitted) examines linearity.

Plot 2 (Normal Q-Q) examines normality of residuals.

Plot 3 (Scale-Location) examines heterscedasticity.

Plot 4 (Residuals vs Leverage) examines Cook's distance.


****

## Hypothesis 2

> Supervisor bottom-line mentality is positively related to employee perceptions of organizational dehumanization.

```{r}
cor.test(dat$sblm, dat$orgdehum, method = "pearson")
```

Hypothesis 2 is supported. 

```{r}
dat %>%
  ggplot(aes(x = sblm, y = orgdehum)) + geom_point() + geom_smooth(method = "lm") +
  scale_x_continuous("Supervisor's Bottom-line Mentality", breaks = c(1:7)) +
  scale_y_continuous("Organizaitonal Dehumanization", breaks = c(1:7))
```

```{r}
cor.test(dat$sblm, dat$orgdehum, method = "kendall")
```

```{r}
plot(lm(orgdehum ~ sblm, data = dat))
```

****

## Hypothesis 3

> Supervisor bottom-line mentality is related to HR attributions such that (a) employees with high BLM supervisors are more likely to form organization-centric attributions and (b) employees with low BLM supervisors are more likely to form employee-centric attributions.

```{r}
cor.test(dat$sblm, dat$exploitatt, method = "pearson")
```

```{r}
cor.test(dat$sblm, dat$wbatt, method = "pearson")
```

Hypothesis 3 is supported.

```{r}
dat %>%
  ggplot(aes(x = sblm, y = exploitatt)) + geom_point() + geom_smooth(method = "lm") +
  scale_x_continuous("Supervisor's Bottom-line Mentality", breaks = c(1:7)) +
  scale_y_continuous("Organization-centric HR Attributions", breaks = c(1:7))
```

```{r}
dat %>%
  ggplot(aes(x = sblm, y = wbatt)) + geom_point() + geom_smooth(method = "lm") +
  scale_x_continuous("Supervisor's Bottom-line Mentality", breaks = c(1:7)) +
  scale_y_continuous("Employee-centric HR Attributions", breaks = c(1:7))
```

```{r}
cor.test(dat$sblm, dat$exploitatt, method = "kendall")
cor.test(dat$sblm, dat$wbatt, method = "kendall")
```

```{r}
plot(lm(exploitatt ~ sblm, data = dat))
```

```{r}
plot(lm(wbatt ~ sblm, data = dat))
```

****

## Hypothesis 4

> Supervisor bottom-line mentality has a positive indirect effect on employee perceptions of organizational dehumanization through HR attributions. Specifically, supervisor BLM relates to organizational dehumanization through its (a) positive effect on organizationcentric attributions and (b) negative effect on employee-centric attributions.

```{r}
summary(lm(exploitatt ~ sblm, data = dat))
```

```{r}
summary(mediate(orgdehum ~ sblm + (exploitatt), data = dat, n.iter = 10000, zero = TRUE), digits = 4)
```

Confirming the F-statistic can be calculate for later.
```{r}
df1 <- k <-  length(c("b", "c"))
n <- 400
df2 <- n - k
r2 <- .6024
fstat <- (r2/(1-r2))*(df2/df1)

data.frame("F-statistic" = fstat, "df1" = df1, "df2" = df2)
```


```{r}
summary(lm(wbatt ~ sblm, data = dat))
```

```{r}
summary(mediate(orgdehum ~ sblm + (wbatt), data = dat, n.iter = 10000, zero = TRUE), digits = 4)
```

Confirming the F-statistic can be calculate for later.
```{r}
df1 <- k <-  length(c("b", "c"))
n <- 400
df2 <- n - k
r2 <- .5979
fstat <- (r2/(1-r2))*(df2/df1)

data.frame("F-statistic" = fstat, "df1" = df1, "df2" = df2)
```

Since the psych::mediate function appears to only calculate percentile bootstraps and not bias-corrected bootstraps, rerun analysis in lavaan.

```{r}
indirect.exploit <- '
  # direct effect
    orgdehum ~ c*sblm
  # mediator
    exploitatt ~ a*sblm
    orgdehum ~ b*exploitatt
  # indirect effect
    ab := a*b'

indirect.exploit.fit <- sem(indirect.exploit, data = dat, se = "boot", bootstrap = 10000, meanstructure = TRUE)
parameterEstimates(indirect.exploit.fit, boot.ci.type = "perc")
parameterEstimates(indirect.exploit.fit, boot.ci.type = "bca.simple")
```

```{r}
summary(indirect.exploit.fit, standardized = FALSE)
```

Calculating the F-statistic
```{r}
df1 <- k <-  length(c("b", "c"))
n <- nobs(indirect.exploit.fit)
df2 <- n - k
r2 <- inspect(indirect.exploit.fit, "rsquare")[[1]]
fstat <- (r2/(1-r2))*(df2/df1) # F-statistic

data.frame("F-statistic" = fstat, "df1" = df1, "df2" = df2)
```

```{r}
indirect.wb <- '
  # direct effect
    orgdehum ~ c*sblm
  # mediator
    wbatt ~ a*sblm
    orgdehum ~ b*wbatt
  # indirect effect
    ab := a*b'

indirect.wb.fit <- sem(indirect.wb, data = dat, se = "boot", bootstrap = 10000, meanstructure = TRUE)
parameterEstimates(indirect.wb.fit, boot.ci.type = "perc")
parameterEstimates(indirect.wb.fit, boot.ci.type = "bca.simple")
```

```{r}
summary(indirect.wb.fit, standardized = FALSE)
```

Calculating the F-statistic
```{r}
df1 <- k <-  length(c("b", "c"))
n <- nobs(indirect.wb.fit)
df2 <- n - k
r2 <- inspect(indirect.wb.fit, "rsquare")[[1]]
fstat <- (r2/(1-r2))*(df2/df1) # F-statistic

data.frame("F-statistic" = fstat, "df1" = df1, "df2" = df2)
```

Hypothesis 4 is supported.

## Hypothesis 5

> Supervisor organizational embodiment moderates the positive relationship between supervisor bottom-line mentality and employee perceptions of organizational dehumanization. Specifically, the relationship between supervisor BLM and organizational dehumanization should be more (less) positive at high (low) levels of supervisor organizational embodiment.

```{r}
summary(lm(orgdehum ~ sblmc*soec, data = dat))
```

### Plot Interaction (Factor Predictor)
```{r}
mod1 <- lm(orgdehum ~ sblmc*soec, data = dat)
inter.sd <- effect(c("sblmc*soec"), mod1,
                     xlevels = list(sblmc = c(-sd(dat$sblmc), +sd(dat$sblmc)),
                                  soec = c(-sd(dat$soec), +sd(dat$soec))))
inter.sd <- as.data.frame(inter.sd)

# Create factors of the different variables
inter.sd$sblm <- factor(inter.sd$sblmc,
                      levels = c(-sd(dat$sblmc), +sd(dat$sblmc)),
                      labels = c("-1 SD SBLM", "+ 1 SD SBLM"))
                     
inter.sd$soe <- factor(inter.sd$soec,
              levels = c(-sd(dat$soe), +sd(dat$soec)),
              labels = c("-1 SD SOE", "+1 SD SOE"))

# Plot 
ggplot(data = inter.sd, aes(x = sblm, y = fit, group = soe, shape = soe, linetype = soe)) +
      geom_point(size = 3) + geom_line(size = 1) +
      scale_linetype_manual(values = c("dashed", "solid")) +
      scale_shape_manual(values = c(17, 16)) +
      scale_x_discrete("Supervisor's Bottom-Line Mentality") +
      scale_y_continuous("Organizational Dehumanization", limits = c(1, 7), breaks = c(1:7)) +
      guides(shape = guide_legend(title = NULL, reverse = TRUE, keywidth = 5),
             linetype = guide_legend(title = NULL, reverse = TRUE, keywidth = 5)) +
      theme(text = element_text(size = 13))
```

### Plot Interaction (Continuous Predictor)
```{r}
rm(mod1)
rm(inter.sd)

mod1 <- lm(orgdehum ~ sblm*soe, data = dat)
inter.sd <- effect(c("sblm*soe"), mod1,
                   xlevels = list(sblm = c(1:7),
                                  soe = c(mean(dat$soe)-sd(dat$soe), 
                                          mean(dat$soe)+sd(dat$soe))))
inter.sd <- as.data.frame(inter.sd)

# Create factors of the moderator

inter.sd$soe <- factor(inter.sd$soe,
                       levels = c(mean(dat$soe)-sd(dat$soe), mean(dat$soe)+sd(dat$soec)),
                       labels = c("-1 SD SOE", "+1 SD SOE"))

# Plot 
ggplot(data = inter.sd, aes(x = sblm, y = fit, group = soe, linetype = soe)) +
  geom_line(size = 1) +
  scale_linetype_manual(values = c("dashed", "solid")) +
  scale_x_continuous("Supervisor's Bottom-Line Mentality", limits = c(1, 7), breaks = c(1:7)) +
  scale_y_continuous("Organizational Dehumanization", limits = c(1, 7), breaks = c(1:7)) +
  guides(shape = guide_legend(title = NULL, reverse = TRUE, keywidth = 5),
         linetype = guide_legend(title = NULL, reverse = TRUE, keywidth = 5)) +
  theme(text = element_text(size = 13))
```

### Obtaining MSE for Reporting
```{r}
c(crossprod(mod1$residuals))/length(mod1$residuals)
```

Hypothesis 5 is supported.

* Notably, SOE exhibits a negative main effect on organizational dehumanization.

## Hypothesis 6

> Supervisor’s organizational embodiment moderates the relationship between supervisor bottom-line mentality and employee HR attributions. Specifically, high (low) supervisor BLM is more strongly related to organization-centric (employee-centric) HR attributions at high levels of supervisor’s organizational embodiment.

```{r}
summary(lm(exploitatt ~ sblmc*soec, data = dat))
```

### Organization-Centric HR Attributions

#### Plot Interaction (Factor Predictor)
```{r}
rm(inter.sd)

mod2 <- lm(exploitatt ~ sblmc*soec, data = dat)
inter.sd <- effect(c("sblmc*soec"), mod2,
                     xlevels = list(sblmc = c(-sd(dat$sblmc), +sd(dat$sblmc)),
                                  soec = c(-sd(dat$soec), +sd(dat$soec))))
inter.sd <- as.data.frame(inter.sd)

# Create factors of the different variables
inter.sd$sblm <- factor(inter.sd$sblmc,
                      levels = c(-sd(dat$sblmc), sd(dat$sblmc)),
                      labels = c("-1 SD SBLM", "+ 1 SD SBLM"))
                     
inter.sd$soe <- factor(inter.sd$soec,
              levels = c(-sd(dat$soec), sd(dat$soec)),
              labels = c("-1 SD SOE", "+1 SD SOE"))

# Plot 
ggplot(data = inter.sd, aes(x = sblm, y = fit, group = soe, shape = soe, linetype = soe)) +
      geom_point(size = 3) + geom_line(size = 1) +
      scale_linetype_manual(values = c("dashed", "solid")) +
      scale_shape_manual(values = c(17, 16)) +      
      scale_x_discrete("Supervisor's Bottom-Line Mentality") +
      scale_y_continuous("Organization-centric HR Attributions", limits = c(1, 7), breaks = c(1:7)) +
      guides(shape = guide_legend(title = NULL, reverse = TRUE, keywidth = 5),
             linetype = guide_legend(title = NULL, reverse = TRUE, keywidth = 5)) +
      theme(text = element_text(size = 13))
```

#### Plot Interaction (Continuous Predictor)
```{r}
rm(mod2)
rm(inter.sd)

mod2 <- lm(exploitatt ~ sblm*soe, data = dat)
inter.sd <- effect(c("sblm*soe"), mod2,
                   xlevels = list(sblm = c(1:7),
                                  soe = c(mean(dat$soe)-sd(dat$soe), 
                                          mean(dat$soe)+sd(dat$soe))))
inter.sd <- as.data.frame(inter.sd)

# Create factors of the moderator

inter.sd$soe <- factor(inter.sd$soe,
                       levels = c(mean(dat$soe)-sd(dat$soe), mean(dat$soe)+sd(dat$soec)),
                       labels = c("-1 SD SOE", "+1 SD SOE"))

# Plot 
ggplot(data = inter.sd, aes(x = sblm, y = fit, group = soe, linetype = soe)) +
  geom_line(size = 1) +
  scale_linetype_manual(values = c("dashed", "solid")) +
  scale_x_continuous("Supervisor's Bottom-Line Mentality", limits = c(1, 7), breaks = c(1:7)) +
  scale_y_continuous("Organization-Centric HR Attributions", limits = c(1, 7), breaks = c(1:7)) +
  guides(shape = guide_legend(title = NULL, reverse = TRUE, keywidth = 5),
         linetype = guide_legend(title = NULL, reverse = TRUE, keywidth = 5)) +
  theme(text = element_text(size = 13))
```

#### Obtaining MSE for Reporting
```{r}
c(crossprod(mod2$residuals))/length(mod2$residuals)
```

### Employee-Centric HR Attributions
```{r}
summary(lm(wbatt ~ sblmc*soec, data = dat))
```

#### Plot Interaction (Factor Predictor)
```{r}
rm(inter.sd)

mod3 <- lm(wbatt ~ sblmc*soec, data = dat)
inter.sd <- effect(c("sblmc*soec"), mod3,
                     xlevels = list(sblmc = c(-sd(dat$sblmc), +sd(dat$sblmc)),
                                  soec = c(-sd(dat$soec), +sd(dat$soec))))
inter.sd <- as.data.frame(inter.sd)

# Create factors of the different variables
inter.sd$sblm <- factor(inter.sd$sblmc,
                      levels = c(-sd(dat$sblmc), sd(dat$sblmc)),
                      labels = c("-1 SD SBLM", "+ 1 SD SBLM"))
                     
inter.sd$soe <- factor(inter.sd$soec,
              levels = c(-sd(dat$soec), sd(dat$soec)),
              labels = c("-1 SD SOE", "+1 SD SOE"))

# Plot 
ggplot(data = inter.sd, aes(x = sblm, y = fit, group = soe, shape = soe, linetype = soe)) +
      geom_point(size = 3) + geom_line(size = 1) +
      scale_linetype_manual(values = c("dashed", "solid")) +
      scale_shape_manual(values = c(17, 16)) +
      scale_x_discrete("Supervisor's Bottom-Line Mentality") +
      scale_y_continuous("Employee-centric HR Attributions", limits = c(1, 7), breaks = c(1:7)) +
      guides(shape = guide_legend(title = NULL, reverse = TRUE, keywidth = 5),
             linetype = guide_legend(title = NULL, reverse = TRUE, keywidth = 5)) +
      theme(text = element_text(size = 13))
```

#### Plot Interaction (Continuous Predictor)
```{r}
rm(mod3)
rm(inter.sd)

mod3 <- lm(wbatt ~ sblm*soe, data = dat)
inter.sd <- effect(c("sblm*soe"), mod3,
                   xlevels = list(sblm = c(1:7),
                                  soe = c(mean(dat$soe)-sd(dat$soe), 
                                          mean(dat$soe)+sd(dat$soe))))
inter.sd <- as.data.frame(inter.sd)

# Create factors of the moderator

inter.sd$soe <- factor(inter.sd$soe,
                       levels = c(mean(dat$soe)-sd(dat$soe), mean(dat$soe)+sd(dat$soec)),
                       labels = c("-1 SD SOE", "+1 SD SOE"))

# Plot 
ggplot(data = inter.sd, aes(x = sblm, y = fit, group = soe, linetype = soe)) +
  geom_line(size = 1) +
  scale_linetype_manual(values = c("dashed", "solid")) +
  scale_x_continuous("Supervisor's Bottom-Line Mentality", limits = c(1, 7), breaks = c(1:7)) +
  scale_y_continuous("Employee-Centric HR Attributions", limits = c(1, 7), breaks = c(1:7)) +
  guides(shape = guide_legend(title = NULL, reverse = TRUE, keywidth = 5),
         linetype = guide_legend(title = NULL, reverse = TRUE, keywidth = 5)) +
  theme(text = element_text(size = 13))
```

#### Obtaining MSE for Reporting
```{r}
c(crossprod(mod3$residuals))/length(mod3$residuals)
```

Hypothesis 6 is partially supported.

* Supported for organization-centric attributions.

* Not supported for employee-centric attributions.

* Notably, SOE appears to exhibit a substantial main effect. SOE positively impacts employee-centric attributions and negatively impacts organization-centric attributions.

## Hypothesis 7

> Supervisor’s organizational embodiment moderates the positive indirect effect of supervisor bottom-line mentality on employee perceptions of organizational dehumanization through HR attributions. Specifically, the indirect effect of supervisor BLM on organizational dehumanization is more positive at high levels of supervisor’s organizational embodiment.

### Using psych::mediate

```{r}
summary(mediate(orgdehum ~ sblm*soe + (exploitatt), data = dat, n.iter = 10000, zero = TRUE), digits = 4)
```

```{r}
summary(mediate(orgdehum ~ sblm*soe + (wbatt), data = dat, n.iter = 10000, zero = TRUE), digits = 4)
```

The psych::mediate function does not appear appropriate for this analysis as it includes an estimate of the interaction term on the outcome variable (c'3). This appears to be an analysis for Model 8 of Process, not Model 7.

### Using lavaan::sem

Need to manually create interaction term for lavaan.
```{r}
dat %<>%
  mutate(sblmxsoe = sblm*soe) %>% # Uncentered
  mutate(sblmcxsoec = sblmc*soec) # Centered
```

```{r}
summary(lm(exploitatt ~ sblmc*soec, data = dat))
```

```{r}
df1 <- k <-  length(c("a1", "a2", "a3"))
n <- 400
df2 <- n - k
r2 <- .394
fstat <- (r2/(1-r2))*(df2/df1) # F-statistic

data.frame("F-statistic" = fstat, "df1" = df1, "df2" = df2)
```

```{r}
condindirect.exploit <- '
  # direct effect
    orgdehum ~ c*sblmc
  # mediator
    exploitatt ~ a1*sblmc + a2*soec + a3*sblmcxsoec
    orgdehum ~ b*exploitatt
  # indirect effect (index of moderated mediation)
    ab := a3*b
  # total effect
    total := c + (a1 + a2 + a3)*b
'
    
condindirect.exploit.fit <- sem(condindirect.exploit, data = dat, se = "boot", bootstrap = 10000, meanstructure = TRUE)
parameterEstimates(condindirect.exploit.fit, boot.ci.type = "perc")
parameterEstimates(condindirect.exploit.fit, boot.ci.type = "bca.simple")
```

```{r}
condindirect.exploit2 <- '
  # direct effect
    orgdehum ~ c*sblmc
  # mediator
    exploitatt ~ a1*sblmc + a2*soec + a3*sblmcxsoec
    orgdehum ~ b*exploitatt
  # indirect effect (index of moderated mediation)
    ab := a3*b
  # total effect
    total := c + (a1 + a2 + a3)*b

  # mean of centered SOE (for simple slopes)
    soec ~ soec.mean*1
  # variance of centered SOE (for simple slopes)
    soec ~~ soec.var*soec
  # indirect effects conditional on moderator (a1 + a3*a2.value)*b
    indirect.SDbelow := a1*b + a3*b*(-sqrt(soec.var))
    indirect.mean := a1*b + a3*soec.mean*b
    indirect.SDabove := a1*b + a3*b*(sqrt(soec.var))
'
 
condindirect.exploit.fit2 <- sem(condindirect.exploit2, data = dat, se = "boot", bootstrap = 10000, meanstructure = TRUE)
parameterEstimates(condindirect.exploit.fit2, boot.ci.type = "perc")
parameterEstimates(condindirect.exploit.fit2, boot.ci.type = "bca.simple")
```


```{r}
summary(condindirect.exploit.fit, standardized = FALSE)
```

```{r}
inspect(condindirect.exploit.fit, "rsquare")
```

Calculating F
```{r}
df1 <- k <-  length(c("b", "c"))
n <- nobs(condindirect.exploit.fit)
df2 <- n - k
r2 <- inspect(condindirect.exploit.fit, "rsquare")[[1]]
fstat <- (r2/(1-r2))*(df2/df1) # F-statistic

data.frame("F-statistic" = fstat, "df1" = df1, "df2" = df2)
```

#### Probing the Conditional Indirect Effect
```{r}
w <- c(-sd(dat$soec), 0, +sd(dat$soec))
a1 <- coef(condindirect.exploit.fit)[["a1"]]
a3 <- coef(condindirect.exploit.fit)[["a3"]]
b <- coef(condindirect.exploit.fit)[["b"]]
condindirect.probe <- data.frame(w, a1, a3, b)

condindirect.probe %>%
  rowwise() %>%
  mutate(thetaxm = a1 + a3*w) %>%
  mutate(indirect = thetaxm*b)
```

Results appear to match the ones above.

> a3b is the difference between the conditional indirect effects between groups of people that differ by one unit in the moderator (Hayes, 2017, p. 453)

```{r}
summary(lm(wbatt ~ sblmc*soec, data = dat))
```

```{r}
condindirect.wb <- '
  # direct effect
    orgdehum ~ c*sblmc
  # mediator
    wbatt ~ a1*sblmc + a2*soec + a3*sblmcxsoec
    orgdehum ~ b*wbatt
  # indirect effect (index of moderated mediation)
    ab := a3*b
  # total effect
    total := c + (a1 + a2 + a3)*b
'
    
condindirect.wb.fit <- sem(condindirect.wb, data = dat, se = "boot", bootstrap = 10000, meanstructure = TRUE)
parameterEstimates(condindirect.wb.fit, boot.ci.type = "perc")
parameterEstimates(condindirect.wb.fit, boot.ci.type = "bca.simple")
```

```{r}
summary(condindirect.wb.fit, standardized = FALSE)
```


```{r}
inspect(condindirect.wb.fit, "rsquare")
```

Calculating F
```{r}
df1 <- k <-  length(c("b", "c"))
n <- nobs(condindirect.wb.fit)
df2 <- n - k
r2 <- inspect(condindirect.wb.fit, "rsquare")[[1]]
fstat <- (r2/(1-r2))*(df2/df1) # F-statistic

data.frame("F-statistic" = fstat, "df1" = df1, "df2" = df2)
```

Hypothesis 7 is partially supported.

* Supported for organization-centric attributions. Note: effect is quite small.

* Not supported for employee-centric attributions.

## Hypothesis 8

> Organizational dehumanization is negatively related to job satisfaction.

```{r}
cor.test(dat$orgdehum, dat$jobsat, method = "pearson")
```

Hypothesis 8 is supported.

```{r}
dat %>%
  ggplot(aes(x = orgdehum, y = jobsat)) + geom_point() + geom_smooth(method = "lm") +
  scale_x_continuous("Organizational Dehumanization", breaks = c(1:7)) +
  scale_y_continuous("Job Satisfaction", breaks = c(1:7))
```

```{r}
cor.test(dat$orgdehum, dat$jobsat, method = "kendall")
```

```{r}
plot(lm(jobsat ~ orgdehum, data = dat))
```

Diagnostic plots generally looks fine, although the scale-location plot indicates slight heteroscedasticity.

## Hypothesis 9

> Organizational dehumanization is negatively related to affective commitment.

```{r}
cor.test(dat$orgdehum, dat$acommit, method = "pearson")
```

Hypothesis 9 is supported.

```{r}
dat %>%
  ggplot(aes(x = orgdehum, y = acommit)) + geom_point() + geom_smooth(method = "lm") +
  scale_x_continuous("Organizational Dehumanization", breaks = c(1:7)) +
  scale_y_continuous("Affective Commitment", breaks = c(1:7))
```

```{r}
cor.test(dat$orgdehum, dat$acommit, method = "kendall")
```

```{r}
plot(lm(acommit ~ orgdehum, data = dat))
```


## Hypothesis 10

> Organizational dehumanization is positively related to turnover intentions.

```{r}
cor.test(dat$orgdehum, dat$tointent, method = "pearson")
```

Hypothesis 10 is supported.

```{r}
dat %>%
  ggplot(aes(x = orgdehum, y = tointent)) + geom_point() + geom_smooth(method = "lm") +
  scale_x_continuous("Organizational Dehumanization", breaks = c(1:7)) +
  scale_y_continuous("Turnover Intentions", breaks = c(1:7))
```

```{r}
cor.test(dat$orgdehum, dat$tointent, method = "kendall")
```

```{r}
plot(lm(tointent ~ orgdehum, data = dat))
```


## Hypothesis 11

> Organizational dehumanization is positively related to burnout.

```{r}
cor.test(dat$orgdehum, dat$burnout, method = "pearson")
```

Hypothesis 11 is supported.

```{r}
dat %>%
  ggplot(aes(x = orgdehum, y = burnout)) + geom_point() + geom_smooth(method = "lm") +
  scale_x_continuous("Organizational Dehumanization", breaks = c(1:7)) +
  scale_y_continuous("Burnout", breaks = c(1:7))
```

```{r}
cor.test(dat$orgdehum, dat$burnout, method = "kendall")
```

```{r}
plot(lm(burnout ~ orgdehum, data = dat))
```

### Burnout Dimensions

```{r}
cor.test(dat$orgdehum, dat$diseng, method = "pearson")
cor.test(dat$orgdehum, dat$exhaust, method = "pearson")
```

## Hypothesis 12

> Organizational dehumanization is negatively related to task performance.

```{r}
cor.test(dat$orgdehum, dat$perf, method = "pearson")
```

Hypothesis 12 is supported.

```{r}
dat %>%
  ggplot(aes(x = orgdehum, y = perf)) + geom_point() + geom_smooth(method = "lm") +
  scale_x_continuous("Organizational Dehumanization", breaks = c(1:7)) +
  scale_y_continuous("Task Performance", breaks = c(1:7))
```

However, the scatterplot indicates the variables do not have a bivariate normal distribution.

```{r}
cor.test(dat$orgdehum, dat$perf, method = "kendall")
```

```{r}
plot(lm(perf ~ orgdehum, data = dat))
```

Q-Q plot indicates non-normality of residuals.

## Hypothesis 13

> Organizational dehumanization is negatively related to organizational citizenship behaviors.

```{r}
cor.test(dat$orgdehum, dat$ocb, method = "pearson")
```

Hypothesis 13 is not supported.

```{r}
dat %>%
  ggplot(aes(x = orgdehum, y = ocb)) + geom_point() + geom_smooth(method = "lm") +
  scale_x_continuous("Organizational Dehumanization", breaks = c(1:7)) +
  scale_y_continuous("Organizaitonal Citizenship Behaviors", breaks = c(1:7))
```

```{r}
cor.test(dat$orgdehum, dat$ocb, method = "kendall")
```

```{r}
plot(lm(ocb ~ orgdehum, data = dat))
```

## Hypothesis 14

> Organizational dehumanization is positively related to counterproductive work behaviors.

```{r}
cor.test(dat$orgdehum, dat$cwb, method = "pearson")
```

Hypothesis 14 is supported.

```{r}
dat %>%
  ggplot(aes(x = orgdehum, y = cwb)) + geom_point() + geom_smooth(method = "lm") +
  scale_x_continuous("Organizational Dehumanization", breaks = c(1:7)) +
  scale_y_continuous("Counterproductive Work Behaviors", breaks = c(1:7))
```

```{r}
cor.test(dat$orgdehum, dat$cwb, method = "kendall")
```

```{r}
plot(lm(cwb ~ orgdehum, data = dat))
```

****
# Examining HR Practices

## HR Practices Descriptives
```{r}
dat %>%
  group_by(selection) %>%
  tally()
```

Few people experience no selection practices at all.

```{r}
dat %>%
  group_by(training) %>%
  tally()
```

```{r}
dat %>%
  group_by(appraisal) %>%
  tally()
```

```{r}
dat %>%
  group_by(compensation) %>%
  tally()
```

```{r}
dat %>%
  group_by(hrpractices) %>%
  tally()
```

## HR Practices Correlations
```{r}
source("corstars.R")

dat %>%
  select(hrpractices, selection:compensation, orgdehum, exploitatt:wbatt, sblm, orgdehum, pos) %>%
  as.matrix(.) %>%
  corstars(., method = "pearson")
```

Sum of HR practices generally seems to be related to positive outcomes.

## HR Practice Descriptive: Specific Items
```{r}
dat %>%
  summarise_at(vars(selection_1:compens_3), sum, na.rm = FALSE)
```


## HR Practice Correlations: Specific Items
```{r}
source("corstars.R")

dat %>%
  select(selection_1:compens_3, orgdehum, exploitatt:wbatt, sblm) %>%
  as.matrix(.) %>%
  corstars(., method = "pearson")
```

