---
title: "Dissertation Data Exploration"
author: "Steven T. Tseng"
date: '`r paste("First created on Dec 24, 2019. Updated on", Sys.Date())`'
output: 
  html_notebook:
    theme: cerulean
    highlight: tango
    number_sections: yes
    toc: yes
---

```{r, message = FALSE}
library(dplyr)
library(readxl)
library(psych)
library(lattice)
library(ggplot2)
library(lavaan)
library(magrittr)
library(broom)

options(digits = 3)
theme_set(theme_classic())

dat <- read_xlsx("./Dissertation Data/dissertationdataCOMPLETE.xlsx")
```

# Descriptive Statistics
****
## Demographics
****
### Organization Type
```{r}
dat %>%
  mutate(orgtype = recode(orgtype, `0` = "nonprofit", `1` = "for-profit")) %>%
  select(orgtype) %>%
  group_by(orgtype) %>%
  tally()
```

### Organization Size
```{r}
dat %>%
  mutate(orgsize = recode_factor(orgsize, `1` = "less than 10",
                          `2` = "10 to 49",
                          `3` = "50 to 99",
                          `4` = "100 to 499",
                          `5` = "500 to 999",
                          `6` = "1000 or more"), .ordered = TRUE) %>%
  select(orgsize) %>%
  group_by(orgsize) %>%
  tally()

dat %>%
  mutate(orgsize = recode_factor(orgsize, `1` = "less than 10",
                          `2` = "10 to 49",
                          `3` = "50 to 99",
                          `4` = "100 to 499",
                          `5` = "500 to 999",
                          `6` = "1000 or more"), .ordered = TRUE) %>%
  select(orgsize) %>%
  barchart(.)
```

### Organization Levels
```{r}
dat %>%
  mutate(orglevels = recode_factor(orglevels, `1` = "three or fewer levels",
                                   `2` = "four levels",
                                   `3` = "five levels",
                                   `4` = "six levels",
                                   `5` = "seven levels or more", .ordered = TRUE)) %>%
  select(orglevels) %>%
  group_by(orglevels) %>%
  tally()

dat %>%
  mutate(orglevels = recode_factor(orglevels, `1` = "three or fewer levels",
                                   `2` = "four levels",
                                   `3` = "five levels",
                                   `4` = "six levels",
                                   `5` = "seven levels or more", .ordered = TRUE)) %>%
  select(orglevels) %>%
  barchart(.)
```

### Organization Centrality
```{r}
dat %>%
  mutate(orgcent = recode_factor(orgcent, `1` = "CEO, president, or managing director",
                                 `2` = "corporate management",
                                 `3` = "branch management",
                                 `4` = "input from frontline employees",
                                 `5` = "other"), .ordered = TRUE) %>%
  select(orgcent) %>%
  group_by(orgcent) %>%
  tally()

dat %>%
  mutate(orgcent = recode_factor(orgcent, `1` = "CEO, president, or managing director",
                                 `2` = "corporate management",
                                 `3` = "branch management",
                                 `4` = "input from frontline employees",
                                 `5` = "other"), .ordered = TRUE) %>%
  select(orgcent) %>%
  barchart(.)
```

### Region
```{r}
dat %>%
  select(region) %>%
  group_by(region) %>%
  tally()

dat %>%
  select(region) %>%
  barchart(.)
```

### Industry
```{r}
dat %>%
  select(industry) %>%
  group_by(industry) %>%
  tally()

dat %>%
  select(industry) %>%
  barchart(.)
```

### Employment Status
```{r}
dat %>%
  mutate(status = recode(status, `0` = "full-time",
                         `1` = "part-time")) %>% # recode full-time = 0, part-time = 1
  select(status) %>%
  group_by(status) %>%
  tally()
```


### Responsible for Direct Reports
```{r}
dat %>%
  mutate(dirreport = recode(dirreport, `1` = "yes", `0` = "no")) %>%
  select(dirreport) %>%
  group_by(dirreport) %>%
  tally()

dat %>%
  mutate(dirreport = recode(dirreport, `1` = "yes", `0` = "no")) %>%
  select(dirreport) %>%
  barchart(.)
```

### Salary
```{r}
dat %>%
  mutate(salary = recode_factor(salary, `1` = "less than $10,000",
                                `2` = "$10,000 to $19,999",
                                `3` = "$20,000 to $29,999",
                                `4` = "$30,000 to $39,999",
                                `5` = "$40,000 to $49,999",
                                `6` = "$50,000 to $59,999",
                                `7` = "$60,000 to $69,999",
                                `8` = "$70,000 or more", .ordered = TRUE)) %>%
  select(salary) %>%
  group_by(salary) %>%
  tally()

dat %>%
  mutate(salary = recode_factor(salary, `1` = "less than $10,000",
                                `2` = "$10,000 to $19,999",
                                `3` = "$20,000 to $29,999",
                                `4` = "$30,000 to $39,999",
                                `5` = "$40,000 to $49,999",
                                `6` = "$50,000 to $59,999",
                                `7` = "$60,000 to $69,999",
                                `8` = "$70,000 or more", .ordered = TRUE)) %>%
  select(salary) %>%
  barchart(.)
```

### Weekly Hours
```{r}
dat %>%
  dplyr::select(weekhours)
dat %>%
  dplyr::select(weekhours) %>%
  filter(weekhours < 25)
dat %>%
  dplyr::select(weekhours) %>%
  filter(weekhours >= 40)
histogram(dat$weekhours, type = "count", breaks = c(7.5:72.5))
```


### Gender
```{r}
dat %>%
  mutate(gender = recode(gender, `0` = "male",
                                `1` = "female")) %>%
  select(gender) %>%
  group_by(gender) %>%
  tally()

dat %>%
  mutate(gender = recode_factor(gender, `0` = "male",
                               `1` = "female")) %>%
  select(gender) %>%
  barchart(.)
```

### Age
```{r}
dat %>%
  mutate(age = recode_factor(age, `1` = "18-24",
                             `2` = "25-30",
                             `3` = "31-40",
                             `4` = "41-50",
                             `5` = "51-60",
                             `6` = "over 60")) %>%
  select(age) %>%
  group_by(age) %>%
  tally()

dat %>%
  mutate(age = recode_factor(age, `1` = "18-24",
                             `2` = "25-30",
                             `3` = "31-40",
                             `4` = "41-50",
                             `5` = "51-60",
                             `6` = "over 60")) %>%
  select(age) %>%
  barchart(.)
```

### Race
```{r}
dat %>%
  select(race) %>%
  group_by(race) %>%
  tally()

dat %>%
  select(race) %>%
  barchart(.)
```

### English First Language
```{r}
dat %>%
  mutate(english = recode(english, `1` = "english first language",
                                 `0` = "english not first language")) %>%
  select(english) %>%
  group_by(english) %>%
  tally()
```

### Marital Status
```{r}
dat %>%
  select(marital) %>%
  group_by(marital) %>%
  tally()

dat %>%
  select(marital) %>%
  barchart(.)
```

### Education
```{r}
dat %>%
  mutate(edu = recode_factor(edu, `1` = "high school, GED",
                             `2` = "associates",
                             `3` = "college",
                             `4` = "masters",
                             `5` = "doctoral", .ordered = TRUE)) %>%
  select(edu) %>%
  group_by(edu) %>%
  tally()

dat %>%
    mutate(edu = recode_factor(edu, `1` = "high school, GED",
                             `2` = "associates",
                             `3` = "college",
                             `4` = "masters",
                             `5` = "doctoral", .ordered = TRUE)) %>%
  select(edu) %>%
  barchart(.)
  
```

****

## Constructs of Interest 
****

### HR Attributions
```{r}
dat %>%
  select(exploitatt:wbatt) %>%
  psych::describe(.)
```

### BLM, SOE, Org Dehumanization and POS
```{r}
dat %>%
  select(sblm:pos) %>%
  psych::describe(.)
```

### Outcome Variables
```{r}
dat %>%
  select(jobsat:cwb) %>%
  psych::describe(.)
```

****

Noteworthy observations:

* Exploitation attributions, BLM, and org dehumanization perceptions below scale midpoint

* Sample appears to include mostly individuals with positive job attitudes and low on negative predictors

****

#  Bar Graphs and Histograms

## Exploitation Attributions
```{r}
histogram(dat$exploitatt, type = "count", breaks = c(0.5:7.5))
```

```{r}
qqnorm(dat$exploitatt)
qqline(dat$exploitatt)
```

```{r}
shapiro.test(dat$exploitatt)
```

Data appear to be positively skewed.

## Well-being Attributions
```{r}
histogram(dat$wbatt, type = "count", breaks = c(0.5:7.5))
```

```{r}
qqnorm(dat$wbatt)
qqline(dat$wbatt)
```

```{r}
shapiro.test(dat$wbatt)
```

Negatively skewed.

## BLM
```{r}
histogram(dat$sblm, type = "count", breaks = c(0.5:7.5))
```

```{r}
qqnorm(dat$sblm)
qqline(dat$sblm)
```

```{r}
shapiro.test(dat$sblm)
```

Positively skewed.

## SOE
```{r}
histogram(dat$soe, type = "count", breaks = c(0.5:7.5))
```

```{r}
qqnorm(dat$soe)
qqline(dat$soe)
```

```{r}
shapiro.test(dat$soe)
```

Negative skew.

## Org Dehumanization
```{r}
histogram(dat$orgdehum, type = "count", breaks = c(0.5:7.5))
```

```{r}
qqnorm(dat$orgdehum)
qqline(dat$orgdehum)
```

```{r}
shapiro.test(dat$orgdehum)
```

Positive skew.

**** Note: Variables of interest appear to be non-normal, which violates the assumptions for a significance test for correlations involving the variables.

****

# Scatterplot Matrix

## Antecedents and Org Dehumanization
```{r}
library(car)
dat %>%
  select(exploitatt, wbatt, sblm, soe, orgdehum) %>%
  scatterplotMatrix(.)
```

## Org Dehumanization and Attitudes
```{r}
dat %>%
  select(orgdehum, jobsat, acommit, tointent) %>%
  scatterplotMatrix(.)
```

## Org Dehumanization and Burnout
```{r}
dat %>%
  select(orgdehum, diseng, exhaust, burnout) %>%
  scatterplotMatrix(.)
```

## Org Dehumanization and Performance
```{r}
dat %>%
  select(orgdehum, perf, ocb, cwb) %>%
  scatterplotMatrix(.)
```

****

# Supplemental Analyses: Demographic Differences

****

## Region
```{r}
dat %>%
  group_by(region) %>%
  tally()
```


```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "orgdehum", groupvars = "region", na.rm = TRUE)
```

```{r}
summary(aov(orgdehum ~ region, data = dat))
```

```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "sblm", groupvars = "region", na.rm = TRUE)
```

```{r}
summary(aov(sblm ~ region, data = dat))
```

```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "exploitatt", groupvars = "region", na.rm = TRUE)
```

```{r}
summary(aov(exploitatt ~ region, data = dat))
```

```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "wbatt", groupvars = "region", na.rm = TRUE)
```

```{r}
summary(aov(wbatt ~ region, data = dat))
```

No significant mean differences in variables of interest across regions.

****

## Industry
```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "orgdehum", groupvars = "industry", na.rm = TRUE)
```

```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "sblm", groupvars = "industry", na.rm = TRUE)
```

```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "exploitatt", groupvars = "industry", na.rm = TRUE)
```

```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "wbatt", groupvars = "industry", na.rm = TRUE)
```

Note: Very low n-size for certain industries. Consider dropping groups.

Specifically, the following categories have N < 20:

```{r}
dat %>%
  group_by(industry) %>%
  select(industry) %>%
  count() %>%
  filter(freq < 20)
```

### ANOVA (Org Dehumanization)
Test for homogeneity of variance first. Use the non-parametric Fligner-Killeen Test.
```{r}
fligner.test(orgdehum ~ industry, data = dat)
fligner.test(sblm ~ industry, data = dat)
fligner.test(exploitatt ~ industry, data = dat)
fligner.test(wbatt ~ industry, data = dat)
```


```{r}
summary(aov(orgdehum ~ industry, data = dat))
```

Significant mean difference in organizational dehumanization between industries.

### Tukey Test (Org Dehumanization)
```{r}
tukey.odhindustry <- tidy(TukeyHSD(aov(orgdehum ~ industry, data = dat)))

tukey.odhindustry %>%
  select(-term) %>%
  filter(adj.p.value < .05)
```

None of the groups compared above had N < 20.

### Create labels with capitalized letters for graphing
```{r}
dat$industry <- as.factor(dat$industry)
```


### Visualization (Org Dehumanization)
```{r}
source("summarySE.R")

dat %>%
  select(industry, orgdehum) %>%
  filter(industry %in% c("arts, entertainment, recreation", "accommodation, food services")) %>%
  group_by(industry) %>%
  summarySE(., measurevar = "orgdehum", groupvars = "industry", na.rm = TRUE)

dat %>%
  filter(industry %in% c("arts, entertainment, recreation", "accommodation, food services")) %>%
  summarySE(., measurevar = "orgdehum", groupvars = "industry", na.rm = TRUE) %>%
  ggplot(aes(x = industry, y = orgdehum, group = industry, fill = industry)) +
  geom_bar(stat = "identity", width = 0.3) +
  scale_fill_grey(start = .4, end = .8) +
  geom_errorbar(aes(ymin = orgdehum - ci, ymax = orgdehum + ci), size = 0.5, width = 0.07) +
  scale_x_discrete(labels = c("Accommodation, Food Services", "Arts, Entertainment, Recreation")) +
  scale_y_continuous(expand = c(0,0), limits = c(0,7), breaks = c(1:7)) +
  labs(x = "Industry", y = "Organizational Dehumanization") +
  theme(text = element_text(size = 13)) + guides(fill = FALSE)
```

```{r}
source("summarySE.R")

dat %>%
  select(industry, orgdehum) %>%
  filter(industry %in% c("finance, insurance", "accommodation, food services")) %>%
  group_by(industry) %>%
  summarySE(., measurevar = "orgdehum", groupvars = "industry", na.rm = TRUE)

dat %>%
  filter(industry %in% c("finance, insurance", "accommodation, food services")) %>%
  summarySE(., measurevar = "orgdehum", groupvars = "industry", na.rm = TRUE) %>%
  ggplot(aes(x = industry, y = orgdehum, group = industry, fill = industry)) +
  scale_fill_grey(start = .4, end = .8) +
  geom_bar(stat = "identity", width = 0.3) +
  geom_errorbar(aes(ymin = orgdehum - ci, ymax = orgdehum + ci), size = 0.5, width = 0.07) +
  scale_x_discrete(labels = c("Accommodation, Food Services", "Finance, Insurance")) +  
  scale_y_continuous(expand = c(0,0), limits = c(0,7), breaks = c(1:7)) +
  labs(x = "Industry", y = "Organizational Dehumanization") +
  theme(text = element_text(size = 13)) + guides(fill = FALSE)
```

```{r}
source("summarySE.R")

dat %>%
  select(industry, orgdehum) %>%
  filter(industry %in% c("retail trade", "arts, entertainment, recreation")) %>%
  group_by(industry) %>%
  summarySE(., measurevar = "orgdehum", groupvars = "industry", na.rm = TRUE)

dat %>%
  filter(industry %in% c("retail trade", "arts, entertainment, recreation")) %>%
  summarySE(., measurevar = "orgdehum", groupvars = "industry", na.rm = TRUE) %>%
  ggplot(aes(x = industry, y = orgdehum, group = industry, fill = industry)) +
  geom_bar(stat = "identity", width = 0.3) +
  scale_fill_grey(start = .4, end = .8) +
  geom_errorbar(aes(ymin = orgdehum - ci, ymax = orgdehum + ci), size = 0.5, width = 0.07) +
  scale_x_discrete(labels = c("Arts, Entertainment, Recreation", "Retail Trade")) +
  scale_y_continuous(expand = c(0,0), limits = c(0,7), breaks = c(1:7)) +
  labs(x = "Industry", y = "Organizational Dehumanization") +
  theme(text = element_text(size = 13)) + guides(fill = FALSE)
```

```{r}
source("summarySE.R")

dat %>%
  select(industry, orgdehum) %>%
  filter(industry %in% c("retail trade", "educational services")) %>%
  group_by(industry) %>%
  summarySE(., measurevar = "orgdehum", groupvars = "industry", na.rm = TRUE)

dat %>%
  filter(industry %in% c("retail trade", "educational services")) %>%
  summarySE(., measurevar = "orgdehum", groupvars = "industry", na.rm = TRUE) %>%
  ggplot(aes(x = industry, y = orgdehum, group = industry, fill = industry)) +
  geom_bar(stat = "identity", width = 0.3) +
  scale_fill_grey(start = .4, end = .8) +
  geom_errorbar(aes(ymin = orgdehum - ci, ymax = orgdehum + ci), size = 0.5, width = 0.07) +
  scale_x_discrete(labels = c("Educational Services", "Retail Trade")) +
  scale_y_continuous(expand = c(0,0), limits = c(0,7), breaks = c(1:7)) +
  labs(x = "Industry", y = "Organizational Dehumanization") +
  theme(text = element_text(size = 13)) + guides(fill = FALSE)
```

```{r}
source("summarySE.R")

dat %>%
  select(industry, orgdehum) %>%
  filter(industry %in% c("retail trade", "finance, insurance")) %>%
  group_by(industry) %>%
  summarySE(., measurevar = "orgdehum", groupvars = "industry", na.rm = TRUE)

dat %>%
  filter(industry %in% c("retail trade", "finance, insurance")) %>%
  summarySE(., measurevar = "orgdehum", groupvars = "industry", na.rm = TRUE) %>%
  ggplot(aes(x = industry, y = orgdehum, group = industry, fill = industry)) +
  geom_bar(stat = "identity", width = 0.3) +
  scale_fill_grey(start = .4, end = .8) +
  geom_errorbar(aes(ymin = orgdehum - ci, ymax = orgdehum + ci), size = 0.5, width = 0.07) +
  scale_x_discrete(labels = c("Finance, Insurance", "Retail Trade")) +
  scale_y_continuous(expand = c(0,0), limits = c(0,7), breaks = c(1:7)) +
  labs(x = "Industry", y = "Organizational Dehumanization") +
  theme(text = element_text(size = 13)) + guides(fill = FALSE)
```

### ANOVA (BLM)
```{r}
summary(aov(sblm ~ industry, data = dat))
```

Significant mean difference in BLM between industries.

### Tukey Test (BLM)
```{r}
tukey.sblmindustry <- tidy(TukeyHSD(aov(sblm ~ industry, data = dat)))

tukey.sblmindustry %>%
  select(-term) %>%
  filter(adj.p.value < .05)
```

### Visualization (BLM)
```{r}
source("summarySE.R")

dat %>%
  select(industry, sblm) %>%
  filter(industry %in% c("educational services", "accommodation, food services")) %>%
  group_by(industry) %>%
  summarySE(., measurevar = "sblm", groupvars = "industry", na.rm = TRUE)

dat %>%
  filter(industry %in% c("educational services", "accommodation, food services")) %>%
  summarySE(., measurevar = "sblm", groupvars = "industry", na.rm = TRUE) %>%
  ggplot(aes(x = industry, y = sblm, group = industry, fill = industry)) +
  geom_bar(stat = "identity", width = 0.3) +
  scale_fill_grey(start = .4, end = .8) +
  geom_errorbar(aes(ymin = sblm - ci, ymax = sblm + ci), size = 0.5, width = 0.07) +
  scale_x_discrete(labels = c("Accommodation, Food Services", "Educational Services")) +
  scale_y_continuous(expand = c(0,0), limits = c(0,7), breaks = c(1:7)) +
  labs(x = "Industry", y = "Supervisor's Bottom-Line Mentality") +
  theme(text = element_text(size = 13)) + guides(fill = FALSE)
```

```{r}
source("summarySE.R")

dat %>%
  select(industry, sblm) %>%
  filter(industry %in% c("finance, insurance", "accommodation, food services")) %>%
  group_by(industry) %>%
  summarySE(., measurevar = "sblm", groupvars = "industry", na.rm = TRUE)

dat %>%
  filter(industry %in% c("finance, insurance", "accommodation, food services")) %>%
  summarySE(., measurevar = "sblm", groupvars = "industry", na.rm = TRUE) %>%
  ggplot(aes(x = industry, y = sblm, group = industry, fill = industry)) +
  geom_bar(stat = "identity", width = 0.3) +
  scale_fill_grey(start = .4, end = .8) +
  geom_errorbar(aes(ymin = sblm - ci, ymax = sblm + ci), size = 0.5, width = 0.07) +
  scale_x_discrete(labels = c("Accommodation, Food Services", "Finance, Insurance")) +
  scale_y_continuous(expand = c(0,0), limits = c(0,7), breaks = c(1:7)) +
  labs(x = "Industry", y = "Supervisor's Bottom-Line Mentality") +
  theme(text = element_text(size = 13)) + guides(fill = FALSE)
```

```{r}
source("summarySE.R")

dat %>%
  select(industry, sblm) %>%
  filter(industry %in% c("retail trade", "educational services")) %>%
  group_by(industry) %>%
  summarySE(., measurevar = "sblm", groupvars = "industry", na.rm = TRUE)

dat %>%
  filter(industry %in% c("retail trade", "educational services")) %>%
  summarySE(., measurevar = "sblm", groupvars = "industry", na.rm = TRUE) %>%
  ggplot(aes(x = industry, y = sblm, group = industry, fill = industry)) +
  geom_bar(stat = "identity", width = 0.3) +
  scale_fill_grey(start = .4, end = .8) +
  geom_errorbar(aes(ymin = sblm - ci, ymax = sblm + ci), size = 0.5, width = 0.07) +
  scale_x_discrete(labels = c("Educational Services", "Retail Trade")) +
  scale_y_continuous(expand = c(0,0), limits = c(0,7), breaks = c(1:7)) +
  labs(x = "Industry", y = "Supervisor's Bottom-Line Mentality") +
  theme(text = element_text(size = 13)) + guides(fill = FALSE)
```

```{r}
source("summarySE.R")

dat %>%
  select(industry, sblm) %>%
  filter(industry %in% c("retail trade", "finance, insurance")) %>%
  group_by(industry) %>%
  summarySE(., measurevar = "sblm", groupvars = "industry", na.rm = TRUE)

dat %>%
  filter(industry %in% c("retail trade", "finance, insurance")) %>%
  summarySE(., measurevar = "sblm", groupvars = "industry", na.rm = TRUE) %>%
  ggplot(aes(x = industry, y = sblm, group = industry, fill = industry)) +
  geom_bar(stat = "identity", width = 0.3) +
  scale_fill_grey(start = .4, end = .8) +
  geom_errorbar(aes(ymin = sblm - ci, ymax = sblm + ci), size = 0.5, width = 0.07) +
  scale_x_discrete(labels = c("Finance, Insurance", "Retail Trade")) +
  scale_y_continuous(expand = c(0,0), limits = c(0,7), breaks = c(1:7)) +
  labs(x = "Industry", y = "Supervisor's Bottom-Line Mentality") +
  theme(text = element_text(size = 13)) + guides(fill = FALSE)
```

### ANOVA (HR Attributions)
```{r}
summary(aov(exploitatt ~ industry, data = dat))
```

```{r}
summary(aov(wbatt ~ industry, data = dat))
```

No significant mean differences in attributions across industries. However, p-values may be considered "marginal".

****

## Marital Status

```{r}
dat %>%
  group_by(marital) %>%
  tally()
```

```{r}
dat %>%
  group_by(marital) %>%
  summarize(orgdehum = mean(orgdehum, na.rm = TRUE),
            sblm = mean(sblm, na.rm = TRUE),
            exploitatt = mean(exploitatt, na.rm = TRUE),
            wbatt = mean(wbatt, na.rm = TRUE))
```

```{r}
summary(aov(orgdehum ~ marital, data = dat))
```

```{r}
summary(aov(sblm ~ marital, data = dat))
```

```{r}
summary(aov(exploitatt ~ marital, data = dat))
```

```{r}
summary(aov(wbatt ~ marital, data = dat))
```

No significant mean differences in variables of interest across marital status.

****

## Race

```{r}
dat %>%
  select(race) %>%
  group_by(race) %>%
  tally()
```

```{r}
dat %>%
  group_by(race) %>%
  summarize(orgdehum = mean(orgdehum, na.rm = TRUE),
            sblm = mean(sblm, na.rm = TRUE),
            exploitatt = mean(exploitatt, na.rm = TRUE),
            wbatt = mean(wbatt, na.rm = TRUE))
```

```{r}
summary(aov(orgdehum ~ race, data = dat))
```

```{r}
summary(aov(sblm ~ race, data = dat))
```

```{r}
summary(aov(exploitatt ~ race, data = dat))
```

```{r}
summary(aov(wbatt ~ race, data = dat))
```

No significant mean differences in variables of interest across races. Notably, however, Black employees appear to differ slightly.

****

## Org Type

Organization type (for-profit vs nonprofit) was correlated with several variables of interest.

### Variable Preparation
```{r}
dat %<>%
  mutate(orgtype = recode_factor(orgtype, `1` = "For-profit",
                          `0` = "Nonprofit"))
```


### Organization Type and Dehumanization
```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "orgdehum", groupvars = "orgtype", na.rm = TRUE)
```

```{r}
t.test(dat$orgdehum ~ dat$orgtype)
```

```{r}
t.test(dat$orgdehum ~ dat$orgtype, var.equal = TRUE)
```

Significant mean difference between groups. Tests assuming equal and unequal variances yield similar results.

```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "orgdehum", groupvars = "orgtype", na.rm = TRUE) %>%
  ggplot(aes(x = orgtype, y = orgdehum, group = orgtype, fill = orgtype)) +
  geom_bar(stat = "identity", width = 0.3) +
  scale_fill_grey(start = .4, end = .8) +
  geom_errorbar(aes(ymin = orgdehum - ci, ymax = orgdehum + ci), size = 0.5, width = 0.07) +
  scale_y_continuous(expand = c(0,0), limits = c(0,7), breaks = c(1:7)) +
  labs(x = "Organization Type", y = "Organizational Dehumanization") +
  theme(text = element_text(size = 13)) + guides(fill = FALSE)
```
Note: Error bars reflect confidence intervals.

### Organization Type and Exploitation Attributions
```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "exploitatt", groupvars = "orgtype", na.rm = TRUE)
```


```{r}
t.test(dat$exploitatt ~ dat$orgtype)
```

```{r}
t.test(dat$exploitatt ~ dat$orgtype, var.equal = TRUE)
```

```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "exploitatt", groupvars = "orgtype", na.rm = TRUE) %>%
  ggplot(aes(x = orgtype, y = exploitatt, group = orgtype, fill = orgtype)) +
  geom_bar(stat = "identity", width = 0.3) +
  scale_fill_grey(start = .4, end = .8) +
  geom_errorbar(aes(ymin = exploitatt - ci, ymax = exploitatt + ci), size = 0.5, width = 0.07) +
  scale_y_continuous(expand = c(0,0), limits = c(0,7), breaks = c(1:7)) +
  labs(x = "Organization Type", y = "Organization-Centric HR Attributions") +
  theme(text = element_text(size = 13)) + guides(fill = FALSE)
```
Note: Error bars reflect confidence intervals.

### Organization Type and BLM
```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "sblm", groupvars = "orgtype", na.rm = TRUE)
```


```{r}
t.test(dat$sblm ~ dat$orgtype)
```

```{r}
t.test(dat$sblm ~ dat$orgtype, var.equal = TRUE)
```

```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "sblm", groupvars = "orgtype", na.rm = TRUE) %>%
  ggplot(aes(x = orgtype, y = sblm, group = orgtype, fill = orgtype)) +
  geom_bar(stat = "identity", width = 0.3) +
  scale_fill_grey(start = .4, end = .8) +
  geom_errorbar(aes(ymin = sblm - ci, ymax = sblm + ci), size = 0.5, width = 0.07) +
  scale_y_continuous(expand = c(0,0), limits = c(0,7), breaks = c(1:7)) +
  labs(x = "Organization Type", y = "Supervisor's Bottom-line Mentality") +
  theme(text = element_text(size = 13)) + guides(fill = FALSE)
```
Note: Error bars reflect confidence intervals.

****

## Org Levels

### Org Levels and Variables of Interest

```{r}
cor.test(dat$orglevels, dat$exploitatt, method = "spearman")
```

Output for Spearman's rho yields a warning that data samples contains correlated ties. Kendall's tau-b coefficient can handle ties (below).

```{r}
cor.test(dat$orglevels, dat$exploitatt, method = "kendall")
```


```{r}
cor.test(dat$orglevels, dat$orgdehum, method = "spearman")

cor.test(dat$orglevels, dat$orgdehum,  method = "kendall")
```

Significant positive correlation between org levels and org dehumanization.

```{r}
cor.test(dat$orglevels, dat$sblm, method = "kendall")
```

```{r}
cor.test(dat$orglevels, dat$wbatt, method = "kendall")
```

No significant rank correlation between org levels and BLM or well-being attributions.

### Variable Preparation for Visualization

```{r}
dat %<>%
  mutate(orglevels = recode_factor(orglevels, `1` = "three or fewer levels",
                                   `2` = "four levels",
                                   `3` = "five levels",
                                   `4` = "six levels",
                                   `5` = "seven levels or more", .ordered = TRUE))
```

### Org Levels and Exploitation Attributions
```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "exploitatt", groupvars = "orglevels")
```

```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "exploitatt", groupvars = "orglevels") %>%
  ggplot(aes(x = orglevels, y = exploitatt, group = 1)) + 
    geom_errorbar(aes(ymin = exploitatt - ci, ymax = exploitatt + ci), width=.1) +
    geom_line() + geom_point() +
    scale_y_continuous(expand = c(0,0), limits = c(1,5)) +
    labs(x = "Levels in Organization", y = "Exploitation Attributions") +
    theme_classic() + guides(fill = FALSE)
```

Note: Error bars reflect confidence intervals.

Confidence intervals appear to overlap substantially.

### Org Levels and Organizational Dehumanization
```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "orgdehum", groupvars = "orglevels", na.rm = TRUE)
```

```{r}
dat %>%
  summarySE(., measurevar = "orgdehum", groupvars = "orglevels", na.rm = TRUE) %>%
  ggplot(aes(x = orglevels, y = orgdehum, group = 1)) + 
    geom_errorbar(aes(ymin = orgdehum - ci, ymax = orgdehum + ci), width=.1) +
    geom_line() + geom_point() +
    scale_y_continuous(expand = c(0,0), limits = c(1,5)) +
    labs(x = "Levels in Organization", y = "Exploitation Attributions") +
    theme_classic() + guides(fill = FALSE)
```

Note: Error bars reflect confidence intervals.

Confidence intervals appear to overlap substantially.

****

## Salary
Note: Add argument subset = (dat$salary != 1) to remove low N group.
```{r}
cor.test(dat$salary, dat$exploitatt, method = "spearman")
cor.test(dat$salary, dat$exploitatt, method = "kendall")
```

Significant negative correlation between salary and exploitation attributions.

```{r}
cor.test(dat$salary, dat$sblm, method = "spearman")
cor.test(dat$salary, dat$sblm, method = "kendall")
```

Significant negative correlation between salary and BLM.

```{r}
cor.test(dat$salary, dat$orgdehum, method = "spearman")
cor.test(dat$salary, dat$orgdehum, method = "kendall")
```

Significant negative correlation between salary and organizational dehumanization.

```{r}
cor.test(dat$salary, dat$wbatt, method = "spearman")
cor.test(dat$salary, dat$wbatt, method = "kendall")
```

Significant positive correlation between salary and well-being attributions.

### Variable Preparation for Visualization
```{r}
dat %<>%
  mutate(salary = recode_factor(salary, `1` = "less than $10,000",
                                `2` = "$10,000 to $19,999",
                                `3` = "$20,000 to $29,999",
                                `4` = "$30,000 to $39,999",
                                `5` = "$40,000 to $49,999",
                                `6` = "$50,000 to $59,999",
                                `7` = "$60,000 to $69,999",
                                `8` = "$70,000 or more", .ordered = TRUE))
```

### Salary and Exploitation Attributions
```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "exploitatt", groupvars = "salary", na.rm = TRUE)
```

Perhaps omit individuals with salary < $10,000 due to low N-size?

```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "exploitatt", groupvars = "salary", na.rm = TRUE) %>%
  ggplot(aes(x = salary, y = exploitatt, group = 1)) + 
    geom_errorbar(aes(ymin = exploitatt - ci, ymax = exploitatt + ci), width=.1) +
    geom_line() + geom_point() +
    scale_y_continuous(expand = c(0,0), limits = c(0,7)) +
    labs(x = "Salary", y = "Exploitation Attributions") +
    theme_classic() + theme(axis.text.x = element_text(angle = 90, hjust = 1))
```
Note: Error bars reflect confidence intervals.
CIs for lowest salary group does not fit within y-scale.

### Salary and Supervisor's Bottom-line Mentality
```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "sblm", groupvars = "salary", na.rm = TRUE)
```

```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "sblm", groupvars = "salary", na.rm = TRUE) %>%
  ggplot(aes(x = salary, y = sblm, group = 1)) + 
    geom_errorbar(aes(ymin = sblm - ci, ymax = sblm + ci), width=.1) +
    geom_line() + geom_point() +
    scale_y_continuous(expand = c(0,0), limits = c(0,7)) +
    labs(x = "Salary", y = "Supervisor's Bottom-line Mentality") +
    theme_classic() + theme(axis.text.x = element_text(angle = 90, hjust = 1))
```


### Salary and Organizational Dehumanization
```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "orgdehum", groupvars = "salary", na.rm = TRUE)
```

```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "orgdehum", groupvars = "salary", na.rm = TRUE) %>%
  ggplot(aes(x = salary, y = orgdehum, group = 1)) + 
    geom_errorbar(aes(ymin = orgdehum - ci, ymax = orgdehum + ci), width=.1) +
    geom_line() + geom_point() +
    scale_y_continuous(expand = c(0,0), limits = c(0,7)) +
    labs(x = "Salary", y = "Organizational Dehumanization") +
    theme_classic() + theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

### Salary and Well-being Attributions
```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "wbatt", groupvars = "salary", na.rm = TRUE)
```

```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "wbatt", groupvars = "salary", na.rm = TRUE) %>%
  ggplot(aes(x = salary, y = wbatt, group = 1)) + 
    geom_errorbar(aes(ymin = wbatt - ci, ymax = wbatt + ci), width=.1) +
    geom_line() + geom_point() +
    scale_y_continuous(expand = c(0,0), limits = c(0,7)) +
    labs(x = "Salary", y = "Well-being Attributions") +
    theme_classic() + theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

****

## Education

```{r}
cor.test(dat$edu, dat$sblm, method = "spearman")
cor.test(dat$edu, dat$sblm, method = "kendall")
```

Significant negative correlation between education and BLM.

```{r}
cor.test(dat$edu, dat$orgdehum, method = "spearman")
cor.test(dat$edu, dat$orgdehum, method = "kendall")
```

Significant negative correlation between education and org dehumanization.

### Variable Preparation for Visualization

```{r}
dat %<>%
  mutate(edu = recode_factor(edu, `1` = "high school, GED",
                             `2` = "associates",
                             `3` = "college",
                             `4` = "masters",
                             `5` = "doctoral", .ordered = TRUE))
```

### Education and BLM
```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "sblm", groupvars = "edu", na.rm = TRUE)
```

```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "sblm", groupvars = "edu", na.rm = TRUE) %>%
  ggplot(aes(x = edu, y = sblm, group = 1)) + 
    geom_errorbar(aes(ymin = sblm - ci, ymax = sblm + ci), width=.1) +
    geom_line() + geom_point() +
    scale_y_continuous(expand = c(0,0), limits = c(0,7)) +
    labs(x = "Education", y = "Supervisor's Bottom-line Mentality") +
    theme_classic() + theme(axis.text.x = element_text(angle = 90, hjust = 1))
```


### Education and Org Dehumanization
```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "orgdehum", groupvars = "edu", na.rm = TRUE)
```

```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "orgdehum", groupvars = "edu", na.rm = TRUE) %>%
  ggplot(aes(x = edu, y = orgdehum, group = 1)) + 
    geom_errorbar(aes(ymin = orgdehum - ci, ymax = orgdehum + ci), width=.1) +
    geom_line() + geom_point() +
    scale_y_continuous(expand = c(0,0), limits = c(0,7)) +
    labs(x = "Education", y = "Organizational Dehumanization") +
    theme_classic() + theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

Notably, education is positively related to salary and responsibility for direct reports.

****
## Responsible for Direct Reports

Responsibility for direct reports correlated with well-being attributions and org dehumanization.

### Variable Preparation
```{r}
dat %<>%
  mutate(dirreport = recode_factor(dirreport, `1` = "Yes",
                                   `0` = "No"))
```

### Responsibility and Well-being Attributions
```{r}
source("summarySE.R")

dat%>%
  summarySE(., measurevar = "wbatt", groupvars = "dirreport", na.rm = TRUE)
```

```{r}
t.test(dat$wbatt ~ dat$dirreport, var.equal = TRUE)
```

```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "wbatt", groupvars = "dirreport", na.rm = TRUE) %>%
  ggplot(aes(x = dirreport, y = wbatt, group = dirreport, fill = dirreport)) +
  geom_bar(stat = "identity", width = 0.3) +
  scale_fill_grey(start = .4, end = .8) +
  geom_errorbar(aes(ymin = wbatt - ci, ymax = wbatt + ci), size = 0.5, width = 0.07) +
  scale_y_continuous(expand = c(0,0), limits = c(0,7), breaks = c(1:7)) +
  labs(x = "Responsibility for Direct Reports", y = "Employee-Centric HR Attributions") +
  theme(text = element_text(size = 13)) + guides(fill = FALSE)
```
Note: Error bars represent confidence intervals.

Although t-test is significant, confidence intervals overlap.

### Responsibility and Org Dehumanization
```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "orgdehum", groupvars = "dirreport", na.rm = TRUE)
```

```{r}
t.test(dat$orgdehum ~ dat$dirreport, var.equal = TRUE)
```

```{r}
source("summarySE.R")

dat %>%
  summarySE(., measurevar = "orgdehum", groupvars = "dirreport", na.rm = TRUE) %>%
  ggplot(aes(x = dirreport, y = orgdehum, group = dirreport, fill = dirreport)) +
  geom_bar(stat = "identity", width = 0.3) +
  scale_fill_grey(start = .4, end = .8) +
  geom_errorbar(aes(ymin = orgdehum - ci, ymax = orgdehum + ci), size = 0.5, width = 0.07) +
  scale_y_continuous(expand = c(0,0), limits = c(0,7), breaks = c(1:7)) +
  labs(x = "Responsibility for Direct Reports", y = "Organizational Dehumanization") +
  theme(text = element_text(size = 13)) + guides(fill = FALSE)
```
Note: Error bars represent confidence intervals.

Although t-test is significant, confidence intervals overlap.

****

# Supplementa Analyses: Probling the Conditional Indirect Effect

```{r}
library(lavaan)

# Need to manually create interaction term
dat %<>%
  mutate(sblmxsoe = sblm*soe) %>% # Uncentered
  mutate(sblmcxsoec = sblmc*soec) # Centered
```

## Conditional Indirect Effect Through Exploit
```{r}
condindirect.exploit <- '
  # direct effect
    orgdehum ~ c*sblmc
  # mediator
    exploitattc ~ a1*sblmc + a2*soec + a3*sblmcxsoec
    orgdehum ~ b*exploitattc
  # indirect effect (index of moderated mediation)
    ab := a3*b
  # total effect
    total := c + (a1 + a2 + a3)*b
  # mean of centered SOE (for simple slopes)
    soec ~ soec.mean*1
  # variance of centered SOE (for simple slopes)
    soec ~~ soec.var*soec
  # indirect effects conditional on moderator (a1 + a3*a2.value)*b
    indirect.SDbelow := a1*b + a3*b*-sqrt(soec.var)
    indirect.mean := a1*b + a3*soec.mean*b
    indirect.SDabove := a1*b + a3*b*sqrt(soec.var)
'
    
condindirect.exploit.fit <- sem(condindirect.exploit, data = dat, se = "boot", bootstrap = 10000)
parameterEstimates(cond.indirect.exploit.fit, boot.ci.type = "bca.simple")
```


## Conditional Indirect Effect Through WB
```{r}
condindirect.wb <- '
  # direct effect
    orgdehum ~ c*sblmc
  # mediator
    wbattc ~ a1*sblmc + a2*soec + a3*sblmcxsoec
    orgdehum ~ b*wbattc
  # indirect effect (index of moderated mediation)
    ab := a3*b
  # total effect
    total := c + (a1 + a2 + a3)*b
  # mean of centered SOE (for simple slopes)
    soec ~ soec.mean*1
  # variance of centered SOE (for simple slopes)
    soec ~~ soec.var*soec
  # indirect effects conditional on moderator (a1 + a3*a2.value)*b
    indirect.SDbelow := a1*b + a3*b*-sqrt(soec.var)
    indirect.mean := a1*b + a3*soec.mean*b
    indirect.SDabove := a1*b + a3*b*sqrt(soec.var)
'
    
condindirect.wb.fit <- sem(condindirect.wb, data = dat, se = "boot", bootstrap = 10000)
parameterEstimates(condindirect.wb.fit, boot.ci.type = "bca.simple")
```


****

# Parallel Mediation
```{r}
indirect.parallel <- '
  # direct effect
    orgdehum ~ c*sblm
  # mediators
    exploitatt ~ a1*sblm
    wbatt ~ a2*sblm
    orgdehum ~ b1*exploitatt + b2*wbatt
  # indirect effects
    a1b1 := a1*b1
    a2b2 := a2*b2
    total := a1b1 + a2b2
'

indirect.parallel.fit <- sem(indirect.parallel, data = dat, se = "boot", bootstrap = 10000, meanstructure = TRUE)
parameterEstimates(indirect.parallel.fit, boot.ci.type = "perc")
parameterEstimates(indirect.parallel.fit, boot.ci.type = "bca.simple")
summary(indirect.parallel.fit, standardized = FALSE)
```

```{r}
inspect(indirect.parallel.fit, "rsquare")
```

Calculating F
```{r}
df1 <- k <-  length(c("b1", "b2", "c"))
n <- nobs(indirect.parallel.fit)
df2 <- n - k
r2 <- inspect(indirect.parallel.fit, "rsquare")[[1]]
fstat <- (r2/(1-r2))*(df2/df1) # F-statistic

data.frame("F-statistic" = fstat, "df1" = df1, "df2" = df2)
```

****

# Conditional Parallel Mediation (a1 moderated)
```{r}
dat %<>%
  mutate(sblmxsoe = sblm*soe) %>% # Uncentered
  mutate(sblmcxsoec = sblmc*soec) # Centered
```


```{r}
cond.parallel <- '
  # direct effect
    orgdehum ~ c*sblmc
  # mediators
    exploitatt ~ a1*sblmc + a3*soec + a4*sblmcxsoec
    wbatt ~ a2*sblmc
    orgdehum ~ b1*exploitatt + b2*wbatt
  # indirect effects
    a1b1 := a1*b1
    a2b2 := a2*b2
  # index of moderated mediation
    a4b1 := a4*b1
  # total indirect effect
    total := a1b1 + a2b2
'

cond.parallel.fit <- sem(cond.parallel, data = dat, se = "boot", bootstrap = 10000, meanstructure = TRUE)
```

```{r}
parameterEstimates(cond.parallel.fit, boot.ci.type = "perc")
parameterEstimates(cond.parallel.fit, boot.ci.type = "bca.simple")
summary(cond.parallel.fit, standardized = FALSE)
```

```{r}
inspect(cond.parallel.fit, "rsquare")
```

Calculating F
```{r}
df1 <- k <- length(c("b1", "b2", "c"))
n <- nobs(cond.parallel.fit)
df2 <- n - k
r2 <- inspect(cond.parallel.fit, "rsquare")[[1]]
fstat <- (r2/(1-r2))*(df2/df1) # F-statistic

data.frame("F-statistic" = fstat, "df1" = df1, "df2" = df2)
```

## Simple Models for Coefficients
```{r}
summary(lm(exploitatt ~ sblm, data = dat))
```

```{r}
summary(lm(wbatt ~ sblm, data = dat))
```

# Conditional Parallel Mediation (a1 and c' moderated)
```{r}
cond.parallel2 <- '
  # direct effect
    orgdehum ~ c*sblmc
  # mediators
    exploitatt ~ a1*sblmc + a3*soec + a4*sblmcxsoec
    wbatt ~ a2*sblmc
    orgdehum ~ b1*exploitatt + b2*wbatt + b3*soec + b4*sblmcxsoec
  # indirect effects
    a1b1 := a1*b1
    a2b2 := a2*b2
  # index of moderated mediation
    a4b1 := a4*b1
  # total indirect effect
    total := a1b1 + a2b2
'

cond.parallel.fit2 <- sem(cond.parallel2, data = dat, se = "boot", bootstrap = 10000, meanstructure = TRUE)
```

```{r}
parameterEstimates(cond.parallel.fit2, boot.ci.type = "perc")
parameterEstimates(cond.parallel.fit2, boot.ci.type = "bca.simple")
summary(cond.parallel.fit2, standardized = FALSE)
```

```{r}
inspect(cond.parallel.fit2, "rsquare")
```

Calculating F
```{r}
df1 <- k <- length(c("b1", "b2", "b3", "b4", "c"))
n <- nobs(cond.parallel.fit2)
df2 <- n - k
r2 <- inspect(cond.parallel.fit2, "rsquare")[[1]]
fstat <- (r2/(1-r2))*(df2/df1) # F-statistic

data.frame("F-statistic" = fstat, "df1" = df1, "df2" = df2)
```

